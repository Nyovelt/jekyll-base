---
title: RSA 与 算法
date: 2020-4-15 9:00:59 +0800
category: Technology
tags: 黑魔法
excerpt: RSA, Prime numbers, EEA and gcd.
---

## What is RSA

![RSA](https://shqb6w.sn.files.1drv.com/y4mtCzO2Ua0b6P5OpXWH54cMbcAGihKdXR0_Ob_TItYp4hFKj9Jwyguso5nEon5CBdrqni4kiy2d2JBNjt0peFP_-NJ5JeUALgCuBFGV15_ppYH2PuE5tdiW323znhvOkYaQy2iHoTRkFjI0tVYhGE-ZSGDRQCu_rBg0V3_phjGiXQfxf6ZZlbekVkR2ZFeRCNzBUliw_j5Njv0O-v5KOfLNA?width=3844&height=2884&cropmode=none)

- RSA 包含了 密钥（公钥，私钥）生成， 加密， 和解密。



## How is RSA

![RSA](https://shqd6w.sn.files.1drv.com/y4mG6nC0p6lZSN6FGrqqR6lllJGiPPn_YZWuCRK6L9hngjbpZ-i1Bvn3kzhYOBrNDUC2RIRBtQkOp1ptoctD1D9a4UkZRTRuHETwRmpJJQMlikOiVZbvrBQZxP_pszLsVQBU7-XA95fc_bZEj6Fl60tFK9WqBzLC3HAUphFWniCS3fNmeAQHNBycAC32JgLlkjyVJcIDo3gsroHv_kuKaFv-w?width=3844&height=2884&cropmode=none)

RSA 的计算过程:

- 首先取两个互素的整数: m, N。 
	- m即要加密的信息
	- 其中 m < N
	- 也可以理解为先找到一个正整数N, 让任意的m<N使m,N互素。
	  - 其中，互素指最大公约数为1，即gcd(m,N) = 1。
	- 这也是RSA算法的真正过程
- N的取法: N = pq, (p,q are prime numbers)

	- N 是凑出来的，为两个素数的积

这时引入**欧拉函数**:
$$
\phi (n) = \mid \mathbb{Z}_n^* \mid
$$
- 构造函数$\phi(n)$表示小于等于 和 互质的数的个数
- 当 $n=pq$ 时， $\phi(n) = (p-1)(q-1)$

举例：

- 任意取两个素数p=7,q=13
- 此时N=pq=91
- 此时$\phi(n) = (p-1)(q-1)=6 \times 12 = 72$

## Private Key and Public Key

Public Key = (N, e)

Private Key = (N, d)

where,

- e是在$\mathbb{Z}_{\phi(n)}^*$中均匀分布的，随机的取一个数字
- 比如在之前的条件中，e为$\mathbb{Z}_\psi(91)^* =\mathbb{Z}_{72}^* = \{1,3,5,7,\dots,71\}$中随意的数字，例如 5
- $\mathbb{Z}_n^*$表示小于n且与n互素的数
- （N和e）即 (15, 5) 组成了公钥
- 而私钥d的计算是 $e^{-1} \bmod \phi(n) = d$，即e的逆元对d取模
  - 乘法逆元: $e e^{-1} \bmod \psi(n) = 1$, $e^{-1}$即逆元
  - 对于 $\psi(15) = 8$的情况，e=5, $e^{-1} = 29$ 